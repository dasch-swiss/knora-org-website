<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Setup Sipi for Knora &#8212; Knora 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Interaction Between Sipi and Knora" href="sipi-and-knora.html" />
    <link rel="prev" title="Sipi" href="index.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">Knora 0.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="index.html" title="Sipi"
             accesskey="P">previous</a> |
          <a href="sipi-and-knora.html" title="Interaction Between Sipi and Knora"
             accesskey="N">next</a> |
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="setup-sipi-for-knora">
<h1>Setup Sipi for Knora<a class="headerlink" href="#setup-sipi-for-knora" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setup-and-execution">
<h2>Setup and Execution<a class="headerlink" href="#setup-and-execution" title="Permalink to this headline">¶</a></h2>
<p>In order to serve files to the client application like the Salsah GUI, Sipi must be set up and running.
Sipi can be downloaded from its own github-repository: <a class="reference external" href="https://github.com/dhlab-basel/Sipi">https://github.com/dhlab-basel/Sipi</a>.
Please follow the instructions given in the README to compile it on your system.</p>
<p>Once it is compiled, you can run Sipi with the following option: <code class="docutils literal"><span class="pre">./local/bin/sipi</span> <span class="pre">--config=config/sipi.knora-config.lua</span></code>
(or <code class="docutils literal"><span class="pre">./local/bin/sipi</span> <span class="pre">--config=sipi.knora-test-config.lua</span></code> for using sipi for testing). Please see <code class="docutils literal"><span class="pre">sipi.knora-config.lua</span></code>
for the settings like URL, port number etc.
These settings need to be set accordingly in Knora&#8217;s <code class="docutils literal"><span class="pre">application.conf</span></code>. If you use the default settings both in Sipi
and Knora, there is no need to change these settings.</p>
<p>Whenever a file is requested from Sipi (e.g. a browser trying to dereference an image link served by Knora), a preflight
function is called.
This function is defined in <code class="docutils literal"><span class="pre">sipi.init-knora.lua</span></code> present in the Sipi root directory. It takes three parameters:
<code class="docutils literal"><span class="pre">prefix</span></code>, <code class="docutils literal"><span class="pre">identifier</span></code> (the name of the requested file), and <code class="docutils literal"><span class="pre">cookie</span></code>. File links created by Knora use the prefix
<code class="docutils literal"><span class="pre">knora</span></code>, e.g. <code class="docutils literal"><span class="pre">http://localhost:1024/knora/incunabula_0000000002.jp2/full/2613,3505/0/default.jpg</span></code>.</p>
<p>Given these information, Sipi asks Knora about the current&#8217;s users permissions on the given file.
The cookie contains the current user&#8217;s Knora session id, so Knora can match Sipi&#8217;s request with a given user profile and
determine the permissions this user has on the file.
If the Knora response grants sufficient permissions, the file is served in the requested quality. If the suer has preview
rights, Sipi serves a reduced quality or integrates a watermark.
If the user has no permissions, Sipi refuses to serve the file. However, all of this behaviour is defined in the preflight
function in Sipi and not controlled by Knora. Knora only provides the permission code.</p>
<p>See <a class="reference internal" href="sipi-and-knora.html#sharing-sessionid-with-sipi"><span class="std std-ref">Sharing the Session ID with Sipi</span></a> for more information about sharing the session id.</p>
</div>
<div class="section" id="using-sipi-in-test-mode">
<h2>Using Sipi in Test Mode<a class="headerlink" href="#using-sipi-in-test-mode" title="Permalink to this headline">¶</a></h2>
<p>If you just want to test Sipi with Knora without serving the actual files (e.g. when executing browser tests), you can
simply start Sipi like this: <code class="docutils literal"><span class="pre">./local/bin/sipi</span> <span class="pre">--config=config/sipi.knora-test-config.lua</span></code>.
Then always the same test file will be served which is included in Sipi. In test mode, Sipi will not aks Knora about
the user&#8217;s permission on the requested file.</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knora-ontologies/index.html">The Knora Ontologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knora-api-server/index.html">The Knora API Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../salsah/index.html">SALSAH</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Sipi</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Setup Sipi for Knora</a></li>
<li class="toctree-l2"><a class="reference internal" href="sipi-and-knora.html">Interaction Between Sipi and Knora</a></li>
</ul>
</li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="index.html" title="Sipi"
              >previous</a> |
            <a href="sipi-and-knora.html" title="Interaction Between Sipi and Knora"
              >next</a> |
            <a href="../../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../../_sources/rst/sipi/setup-sipi-for-knora.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Lukas Rosenthaler, Benjamin Geer, Ivan Subotic, Tobias Schweizer, André Kilchenmann, and Sepideh Alassi.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>