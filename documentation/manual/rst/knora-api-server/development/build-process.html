<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Build Process &#8212; Knora 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Setup IntelliJ for development of Knora" href="intellij-config.html" />
    <link rel="prev" title="Starting GraphDB" href="graphdb.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../../index.html">Knora 0.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="graphdb.html" title="Starting GraphDB"
             accesskey="P">previous</a> |
          <a href="intellij-config.html" title="Setup IntelliJ for development of Knora"
             accesskey="N">next</a> |
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="build-process">
<span id="webapi-build-process"></span><h1>Build Process<a class="headerlink" href="#build-process" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#building-and-running" id="id2">Building and Running</a><ul>
<li><a class="reference internal" href="#using-fuseki" id="id3">Using Fuseki</a></li>
<li><a class="reference internal" href="#using-graphdb" id="id4">Using GraphDB</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-automated-tests" id="id5">Running the automated tests</a><ul>
<li><a class="reference internal" href="#running-tests-with-fuseki" id="id6">Running Tests with Fuseki</a></li>
<li><a class="reference internal" href="#running-tests-with-graphdb" id="id7">Running Tests with GraphDB</a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-testing-on-mac-os-x" id="id8">Load Testing on Mac OS X</a></li>
<li><a class="reference internal" href="#continuous-integration" id="id9">Continuous Integration</a></li>
<li><a class="reference internal" href="#sbt-build-configuration" id="id10">SBT Build Configuration</a></li>
<li><a class="reference internal" href="#webapi-server-startup-flags" id="id11">Webapi Server Startup-Flags</a><ul>
<li><a class="reference internal" href="#loaddemodata-flag" id="id12"><code class="docutils literal"><span class="pre">loadDemoData</span></code> - Flag</a></li>
<li><a class="reference internal" href="#allowreloadoverhttp-flag" id="id13"><code class="docutils literal"><span class="pre">allowReloadOverHTTP</span></code> - Flag</a></li>
</ul>
</li>
</ul>
</div>
<dl class="docutils">
<dt>TODO: complete this file.</dt>
<dd><ul class="first last simple">
<li>SBT</li>
<li>Using GraphDB for development and how to initializing the &#8216;knora-test-unit&#8217; repository</li>
<li>Using Fuseki for development</li>
</ul>
</dd>
</dl>
<div class="section" id="building-and-running">
<h2><a class="toc-backref" href="#id2">Building and Running</a><a class="headerlink" href="#building-and-running" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-fuseki">
<h3><a class="toc-backref" href="#id3">Using Fuseki</a><a class="headerlink" href="#using-fuseki" title="Permalink to this headline">¶</a></h3>
<p>Start the provided Fuseki triplestore:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/triplestores/fuseki
$ ./fuseki-server
</pre></div>
</div>
<p>Then in another terminal, load some test data into the triplestore:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/webapi/scripts
$ ./fuseki-load-test-data.sh
</pre></div>
</div>
<p>Then go back to the webapi root directory and use SBT to start the API server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/webapi
$ sbt
&gt; compile
&gt; re-start
</pre></div>
</div>
<p>To shut down the Knora API server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">re</span><span class="o">-</span><span class="n">stop</span>
</pre></div>
</div>
</div>
<div class="section" id="using-graphdb">
<h3><a class="toc-backref" href="#id4">Using GraphDB</a><a class="headerlink" href="#using-graphdb" title="Permalink to this headline">¶</a></h3>
<p>The archive with the newest supported version of the GraphDB-SE triplestore is provided under
<code class="docutils literal"><span class="pre">`triplestores/graphdb-se`</span></code>. Please keep in mind, that GraphDB-SE must be licensed separately by the user, and that
no license file is provided in the repository. GraphDB-SE will not run without a license file.</p>
<p>Unzip <code class="docutils literal"><span class="pre">graphdb-se-x.x.x-dist.zip</span></code> to a place of your choosing and run the following, to start graphdb:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd /to/unziped/location
$ ./bin/graphdb -Dgraphdb.license.file=/path/to/GRAPHDB_SE.license
</pre></div>
</div>
<p>After the GraphDB inside the docker container has started, you can find the GraphDB workbench here: <a class="reference external" href="http://localhost:7200">http://localhost:7200</a></p>
<p>Then in another terminal, load some test data into the triplestore:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/webapi/scripts
$ ./graphdb-se-local-init-knora-test.sh
</pre></div>
</div>
<p>Then go back to the webapi root directory and use SBT to start the API server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/webapi
$ sbt
&gt; compile
&gt; re-start
</pre></div>
</div>
<p>To shut down the Knora API server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">re</span><span class="o">-</span><span class="n">stop</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-automated-tests">
<h2><a class="toc-backref" href="#id5">Running the automated tests</a><a class="headerlink" href="#running-the-automated-tests" title="Permalink to this headline">¶</a></h2>
<div class="section" id="running-tests-with-fuseki">
<h3><a class="toc-backref" href="#id6">Running Tests with Fuseki</a><a class="headerlink" href="#running-tests-with-fuseki" title="Permalink to this headline">¶</a></h3>
<p>Make sure you&#8217;ve started Fuseki as shown above. Then at the SBT prompt:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">fuseki</span><span class="p">:</span><span class="n">test</span>
</pre></div>
</div>
</div>
<div class="section" id="running-tests-with-graphdb">
<h3><a class="toc-backref" href="#id7">Running Tests with GraphDB</a><a class="headerlink" href="#running-tests-with-graphdb" title="Permalink to this headline">¶</a></h3>
<p>Make sure GraphDB is running (as described earlier).</p>
<p>Then in another terminal, initialise the repository used for automated testing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd KNORA_PROJECT_DIRECTORY/webapi/scripts
$ ./graphdb-se-local-init-knora-test-unit.sh
</pre></div>
</div>
<p>Run the automated tests from sbt:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">graphdb</span><span class="p">:</span><span class="n">test</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-testing-on-mac-os-x">
<h2><a class="toc-backref" href="#id8">Load Testing on Mac OS X</a><a class="headerlink" href="#load-testing-on-mac-os-x" title="Permalink to this headline">¶</a></h2>
<p>To test the Knora API server with many concurrent connections on Mac OS X, you
will need to adjust some kernel parameters to allow more open connections, to
recycle ephemeral ports more quickly, and to use a wider range of ephemeral
port numbers. The script <code class="docutils literal"><span class="pre">webapi/scripts/macOS-kernel-test-config.sh</span></code> will do
this.</p>
</div>
<div class="section" id="continuous-integration">
<h2><a class="toc-backref" href="#id9">Continuous Integration</a><a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h2>
<p>For continuous integration testing, we use Travis-CI. Every commit pushed to the git repository or every
pull request, triggers the build. Additionaly, in Github there is a litle checkmark beside every commit, signaling the
status of the build (successful, unsucessful, ongoing).</p>
<p>The build that is executed on Travis-CI is defined in <code class="docutils literal"><span class="pre">.travis.yml</span></code> situated in the root folder of the project, and
looks like this:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">dist</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">trusty</span>
<span class="l l-Scalar l-Scalar-Plain">sudo</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">required</span>

<span class="l l-Scalar l-Scalar-Plain">addons</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">chrome</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">stable</span>

<span class="l l-Scalar l-Scalar-Plain">git</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">depth</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>

<span class="l l-Scalar l-Scalar-Plain">language</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scala</span>

<span class="l l-Scalar l-Scalar-Plain">scala</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">2.12.1</span>

<span class="l l-Scalar l-Scalar-Plain">jdk</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">oraclejdk8</span>

<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>

<span class="l l-Scalar l-Scalar-Plain">env</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">global</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">secure</span><span class="p p-Indicator">:</span> <span class="s">&quot;Sj0D8wR3Vx0J0h+LBUIh9t1PWjLJ2NEiKILf3JO5nuGdlU7dPhbFomR4w08q85O4d60km38ml7zpapC4noDQnbAFQHC6XeOe5CWPYFXCxkw7ueBoxhy/vkfSzypXp0UTNUX3S7+RcGJcTxLaZcUC9u+UaoWB0LMkmOcIlrKIDuzm3HcefMsml8gYX1xhS2TQJ8P7ZerzBmm0kERYLUabhxTnj5WAvue0d1xbUtzCzT1LpignOfsUZ9kHTagQEA15JsU0iNrMCvlDcxRWj8OzLhHRoHui4bJPQQfKEA8oMnTkPyzBRLmqafqHvmGcNQp9iGhuU04gb+FkF4gubBkLrxEvgTL/D5vIin3BHQvnZna9zSnUguZS+jw4sfEYcjZgYRzgMRPma/630ZM08FSZZ/qjSTCut4Cjua5aw2Vf9pYhf+Aad5rR0T2JmVYKp6Ik92aLhPOF9U40MacKRPPT54RIjCYcakZlmU4vl+kK37l3sYjvD57LeSs3PlqvkpSxwJzaQDhZFOZ+c7ICo+zU7DcQnWkN7k+ErKBOE7r0mIqvYuBYhdteBVKfo8a4rpDzYJDXaWzBdjc8ZKiEFQvFHngnZjR2UtKc0CAc6Y7ieCWIvBZYdMoHhKsBwFDaO1iuWwDLW3cswXaPEqENonlVAnXePu7KkQeB2acwDzPkhlI=&quot;</span> <span class="c1">#DOCKER_USER</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">secure</span><span class="p p-Indicator">:</span> <span class="s">&quot;iM3Wjt3f5yUaU16yKstwBEEFA8WKx8qcTVnOwF+o9+sooD1SZ39nYJDPgpHHNwFZ1aSkre5ATPEw+dfslr7SnnwYQeYHjYldcqudB+7pq4dmY5U3rCTsjZCH1XmLnnLO45CZRy05pIAUSxWpIiX5khWoHZd704UlDncqIU/6paWWNkywPb2P4UBZ5Xeai1NTS1URHRz0A4aD+dqwKS6P+baq4CyKLC/AqjsTDI+TV4C26FXXTgS0Ly9VfBVZ55D+SdVHgCZXJaHerAixjSX6zvenfkd/87GR6NEAgJ9QofF2nDEXBZZm4jPv5d285Cc4iUvRo1HLbI1VlALya3qUA9Prbno8QQaChNdjRS7mSplkCxZZKzBItpjvI009NPl20zX6GROb/JCjWHRZ4R358cebFKKqE4W1GBArS0piVbdqZyWA/t5KANouQIdrh+lepAf/Xq5JRcDP9r+Rk2hHLk2Rmj97gv001eRf9GjSEC1Qo1kwu1FabZok1UIemJHpY7yWO4d3ZKSOCyQ0WdW6rLMFGkouoByrFVfNPBVxLqDJ3YVL/4x5jc0Q9+G5jm6omqNwQSsn60nUizZJp1fuLGQRUNj8EDvRhxLgVkOJqFf4P/4qRas47k1wkWBk2iBlpNp2eQTY42IZovPIyT+NCfbdg0yyZRyHThpfc+KfTeg=&quot;</span> <span class="c1">#DOCKER_PASS</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">WEBAPI_REPO=dhlabbasel/webapi</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SALSAH_REPO=dhlabbasel/salsah</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SIPI_REPO=dhlabbasel/sipi</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DOCKERHOST=$(ip route get 8.8.8.8 | awk &#39;{print $NF; exit}&#39;)</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CHROME_BIN=google-chrome-stable</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">GDB_HEAP_SIZE=&quot;4G&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">cache</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">directories</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">$HOME/.ivy2</span>


<span class="l l-Scalar l-Scalar-Plain">before_install</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">openssl aes-256-cbc -K $encrypted_6254b38dc8d5_key -iv $encrypted_6254b38dc8d5_iv -in $TRAVIS_BUILD_DIR/private/graphdb.license.enc -out $TRAVIS_BUILD_DIR/private/graphdb.license -d</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sudo apt-get -qq update</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sudo apt-get install -y expect</span>

<span class="l l-Scalar l-Scalar-Plain">stages</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">publish</span> <span class="c1"># generally, only publish if we are on &#39;develop&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">if</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">branch = develop</span>

<span class="l l-Scalar l-Scalar-Plain">jobs</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">include</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
      <span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span>
        <span class="c1"># prepare needed graphdb-se files</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mkdir -p $TRAVIS_BUILD_DIR/data/conf</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cp $TRAVIS_BUILD_DIR/private/graphdb.license $TRAVIS_BUILD_DIR/data/conf/graphdb.license</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mkdir -p $TRAVIS_BUILD_DIR/graphdb</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cp $TRAVIS_BUILD_DIR/webapi/scripts/KnoraRules.pie $TRAVIS_BUILD_DIR/graphdb</span>
        <span class="c1"># start and initialize graphdb-se</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker run -d -p 127.0.0.1:7200:7200 -v $TRAVIS_BUILD_DIR/data:/opt/graphdb/home -v $TRAVIS_BUILD_DIR/graphdb:/graphdb ontotext/graphdb:8.2.0-se</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sleep 15</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cd $TRAVIS_BUILD_DIR/webapi/scripts &amp;&amp; ./graphdb-se-docker-init-knora-test-unit.sh</span>
        <span class="c1"># start the built-in webapi server tests</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cd $TRAVIS_BUILD_DIR/webapi/ &amp;&amp; sbt graphdb:test</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
      <span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span>
        <span class="c1"># prepare needed graphdb-se files</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mkdir -p $TRAVIS_BUILD_DIR/data/conf</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cp $TRAVIS_BUILD_DIR/private/graphdb.license $TRAVIS_BUILD_DIR/data/conf/graphdb.license</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mkdir -p $TRAVIS_BUILD_DIR/graphdb</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cp $TRAVIS_BUILD_DIR/webapi/scripts/KnoraRules.pie $TRAVIS_BUILD_DIR/graphdb</span>
        <span class="c1"># start and initialize graphdb-se</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker run -d -p 127.0.0.1:7200:7200 -v $TRAVIS_BUILD_DIR/data:/opt/graphdb/home -v $TRAVIS_BUILD_DIR/graphdb:/graphdb ontotext/graphdb:8.2.0-se</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sleep 15</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cd $TRAVIS_BUILD_DIR/webapi/scripts &amp;&amp; ./graphdb-se-docker-init-knora-test-unit.sh</span>
        <span class="c1"># start the sipi container (with production config)</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker run -d --add-host webapihost:$DOCKERHOST -v /tmp:/tmp -v $HOME:$HOME -p 1024:1024 $SIPI_REPO:develop</span>
        <span class="c1"># start the integration tests</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cd $TRAVIS_BUILD_DIR/webapi/ &amp;&amp; sbt it:test</span>
    <span class="c1">#- stage: test</span>
    <span class="c1">#  script:</span>
    <span class="c1">#    # prepare needed graphdb-se files</span>
    <span class="c1">#    - mkdir -p $TRAVIS_BUILD_DIR/data/conf</span>
    <span class="c1">#    - cp $TRAVIS_BUILD_DIR/private/graphdb.license $TRAVIS_BUILD_DIR/data/conf/graphdb.license</span>
    <span class="c1">#    - mkdir -p $TRAVIS_BUILD_DIR/graphdb</span>
    <span class="c1">#    - cp $TRAVIS_BUILD_DIR/webapi/scripts/KnoraRules.pie $TRAVIS_BUILD_DIR/graphdb</span>
    <span class="c1">#    # start and initialize graphdb-se</span>
    <span class="c1">#    - docker run -d -p 127.0.0.1:7200:7200 -v $TRAVIS_BUILD_DIR/data:/opt/graphdb/home -v $TRAVIS_BUILD_DIR/graphdb:/graphdb ontotext/graphdb:8.2.0-se</span>
    <span class="c1">#    - sleep 15</span>
    <span class="c1">#    - cd $TRAVIS_BUILD_DIR/webapi/scripts &amp;&amp; ./graphdb-se-docker-init-knora-test.sh</span>
    <span class="c1">#    # start the sipi container (with test config)</span>
    <span class="c1">#    - docker run -d --add-host webapihost:$DOCKERHOST -v /tmp:/tmp -v $HOME:$HOME -p 1024:1024 $SIPI_REPO:develop /sipi/local/bin/sipi --config=/sipi/config/sipi.knora-test-docker-config.lua</span>
    <span class="c1">#    # start the webapi and salsah server</span>
    <span class="c1">#    - cd $TRAVIS_BUILD_DIR/webapi/ &amp;&amp; sbt &quot;run allowReloadOverHTTP&quot; &amp;</span>
    <span class="c1">#    - cd $TRAVIS_BUILD_DIR/salsah/ &amp;&amp; sbt run &amp;</span>
    <span class="c1">#    # wait for the webapi server to start before we proceed with running the salsah tests</span>
    <span class="c1">#    - until netstat -an 2&gt;/dev/null | grep &#39;3333.*LISTEN&#39;; do true; done</span>
    <span class="c1">#    # unzip chromedriver</span>
    <span class="c1">#    - cd $TRAVIS_BUILD_DIR/salsah/lib/chromedriver/ &amp;&amp; unzip chromedriver_linux64.zip</span>
    <span class="c1">#    # start built-in salsah browser tests</span>
    <span class="c1">#    - cd $TRAVIS_BUILD_DIR/salsah/ &amp;&amp; sbt headless:test</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">publish</span>
      <span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker login -u $DOCKER_USER -p $DOCKER_PASS</span>
        <span class="c1"># webapi</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker build $TRAVIS_BUILD_DIR/webapi/ -t $WEBAPI_REPO:develop</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker tag $WEBAPI_REPO:develop $WEBAPI_REPO:latest</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker push $WEBAPI_REPO</span>
        <span class="c1"># salsah</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker build $TRAVIS_BUILD_DIR/salsah/ -t $SALSAH_REPO:develop</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker tag $SALSAH_REPO:develop $SALSAH_REPO:latest</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker push $SALSAH_REPO</span>
        <span class="c1"># sipi: get the develop sipi and tag it as &#39;develop-knora&#39; so we know that this version is tested (only on the develop branch)</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker pull $SIPI_REPO:develop</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker tag $SIPI_REPO:develop $SIPI_REPO:knora-develop</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker push $SIPI_REPO</span>

<span class="l l-Scalar l-Scalar-Plain">notifications</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">slack</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">secure</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">gaazomUbAB4q7bH2XOiZXqHvU2gd/X/jIRLAJW9vjcRbY6o48eiEdNXF2umraHG0q+5UUEJ5dfvxiPtC4PiUq8uD6J+R0fEWrWznYoIeEWEXjKxRxWplrWJ9Ke+PJb3wCV6cXBGMfxDpvYQbVjsy7n0aQmjNs4Drz+llqL5SilTdswTylwvUdufad0QaovXklL+p0w9vRHRKzQkYKa9phL10VcJa8TPI74tuFcTHnK6TcMNW6p0vzAaF6JVgzoRPzUgXnEPCw4pI8zqOF1ghPpQByNXKiYofPWt1yTFgb60LQarDEiHXunXAA/sf2gx616pWLVjDFGziXVzhiGUDUjM5I1p7hPyA2rTB63AAZustFcGeD+jbHNHIFhcvvCHVHjJfp8M7LrUR+MBqz5mJNi/9KgxyZ8I9Df28TxmKxGFaGW8t4PZdA75/49Hos0TqtIp5m+eo8mTksUJogEJJokRZUKraMBhC0cNCry0kp+EQ06F4usLoDyZTUar4OSuNSiymf+zwz6jZo8dF/cluRYellwewE9NJiNWGN4DiBhk2vGJ7OtWMDPkl1tqkG8npoqbT4s38esjxfa/XcworGfeqE+9mzugVzkIKIX2lB6QxZp0AKQVOiy7JwwdtcjVMLvceiNPEWfe8fhLMX02oqYz2uoibRmHMxKPa5CpmUIg=</span>
</pre></div>
</td></tr></table></div>
<p>It basically means:</p>
<blockquote>
<div><ul class="simple">
<li>use the virtual machine based environment (line 1)</li>
<li>checkout git with a shorter history (lines 2-3)</li>
<li>add scala libraries (lines 4-6)</li>
<li>add oracle jdk version 8 (lines 7-8)</li>
<li>cache some directories between builds to make it faster (line 9-11)</li>
<li>start fuseki and afterwards start all tests (lines 12-14)</li>
<li>send notification to our slack channel (lines 15-17)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="sbt-build-configuration">
<h2><a class="toc-backref" href="#id10">SBT Build Configuration</a><a class="headerlink" href="#sbt-build-configuration" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span>import sbt._
import NativePackagerHelper._

connectInput in run := true

// Bring the sbt-aspectj settings into this build
//aspectjSettings

lazy val webapi = (project in file(&quot;.&quot;)).
        configs(
            FusekiTest,
            FusekiIntegrationTest,
            GraphDBTest,
            EmbeddedJenaTDBTest,
            IntegrationTest
        ).
        settings(webApiCommonSettings:  _*).
        settings(inConfig(Test)(
            Defaults.testTasks ++ baseAssemblySettings
        ): _*).
        settings(inConfig(FusekiTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaFusekiTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(FusekiIntegrationTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaFusekiIntegrationTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(GraphDBTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaGraphDBTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(EmbeddedJenaTDBTest)(
            Defaults.testTasks ++ Seq(
                fork := true,
                javaOptions ++= javaEmbeddedJenaTDBTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            )
        ): _*).
        settings(inConfig(IntegrationTest)(
            Defaults.itSettings ++ Seq(
                fork := true,
                javaOptions ++= javaIntegrationTestOptions,
                testOptions += Tests.Argument(&quot;-oDF&quot;) // show full stack traces and test case durations
            ) ++ baseAssemblySettings
        ): _*).
        settings(
            libraryDependencies ++= webApiLibs,
            scalacOptions ++= Seq(&quot;-feature&quot;, &quot;-unchecked&quot;, &quot;-deprecation&quot;, &quot;-Yresolve-term-conflict:package&quot;),
            logLevel := Level.Info,
            fork in run := true,
            javaOptions in run ++= javaRunOptions,
            //javaOptions in run &lt;++= AspectjKeys.weaverOptions in Aspectj,
            //javaOptions in Revolver.reStart &lt;++= AspectjKeys.weaverOptions in Aspectj,
            mainClass in (Compile, run) := Some(&quot;org.knora.webapi.Main&quot;),
            fork in Test := true,
            javaOptions in Test ++= javaTestOptions,
            parallelExecution in Test := false,
            // enable publishing the jar produced by `sbt test:package` and `sbt it:package`
            publishArtifact in (Test, packageBin) := true,
            publishArtifact in (IntegrationTest, packageBin) := true
        ).
        settings( // enable deployment staging with `sbt stage`. uses fat jar assembly.
            // we specify the name for our fat jars (main, test, it)
            assemblyJarName in assembly := s&quot;assembly-${name.value}-main-${version.value}.jar&quot;,
            assemblyJarName in (Test, assembly) := s&quot;assembly-${name.value}-test-${version.value}.jar&quot;,
            assemblyJarName in (IntegrationTest, assembly) := s&quot;assembly-${name.value}-it-${version.value}.jar&quot;,
            // disable running of tests before fat jar assembly!
            test in assembly := {},
            test in (Test, assembly) := {},
            test in (IntegrationTest, assembly) := {},
            // Skip packageDoc task on stage
            mappings in (Compile, packageDoc) := Seq(),
            mappings in Universal := {
                // removes all jar mappings in universal and appends the fat jar
                // universalMappings: Seq[(File,String)]
                val universalMappings = (mappings in Universal).value
                val fatJar = (assembly in Compile).value
                // removing means filtering
                val filtered = universalMappings filter {
                    case (file, name) =&gt;  ! name.endsWith(&quot;.jar&quot;)
                }
                // add the fat jar
                filtered :+ (fatJar -&gt; (&quot;lib/&quot; + fatJar.getName))
            },
            mappings in Universal ++= {
                // copy the scripts folder
                directory(&quot;scripts&quot;) ++
                // copy the configuration files to config directory
                contentOf(&quot;configs&quot;).toMap.mapValues(&quot;config/&quot; + _) ++
                // copy configuration files to config directory
                contentOf(&quot;src/main/resources&quot;).toMap.mapValues(&quot;config/&quot; + _)
            },
            // the bash scripts classpath only needs the fat jar
            scriptClasspath := Seq( (assemblyJarName in assembly).value ),
            // add &#39;config&#39; directory first in the classpath of the start script,
            scriptClasspath := Seq(&quot;../config/&quot;) ++ scriptClasspath.value,
            // add license
            licenses := Seq((&quot;GNU AGPL&quot;, url(&quot;https://www.gnu.org/licenses/agpl-3.0&quot;))),
            // need this here, so that the Manifest inside the jars has the correct main class set.
            mainClass in Compile := Some(&quot;org.knora.webapi.Main&quot;),
            mainClass in Test := Some(&quot;org.scalatest.tools.Runner&quot;),
            mainClass in IntegrationTest := Some(&quot;org.scalatest.tools.Runner&quot;)
        ).
        enablePlugins(SbtTwirl). // Enable the sbt-twirl plugin
        enablePlugins(JavaAppPackaging) // Enable the sbt-native-packager plugin

lazy val webApiCommonSettings = Seq(
    organization := &quot;org.knora&quot;,
    name := &quot;webapi&quot;,
    version := &quot;0.1.0-beta&quot;,
    scalaVersion := &quot;2.12.4&quot;
)

lazy val webApiLibs = Seq(
    library.akkaActor,
    library.akkaAgent,
    library.akkaHttp,
    library.akkaHttpCirce,
    library.akkaHttpCors,
    library.akkaHttpSprayJson,
    library.akkaHttpJacksonJava,
    library.akkaHttpTestkit,
    library.akkaHttpXml,
    library.akkaSlf4j,
    library.akkaStream,
    library.akkaStreamTestkit,
    library.akkaTestkit,
    library.bcprov,
    library.commonsBeanUtil,
    library.commonsIo,
    library.commonsLang3,
    library.commonsValidator,
    library.diff,
    library.ehcache,
    library.gwtServlet,
    library.jacksonScala,
    library.jsonldJava,
    library.jodd,
    library.jodaTime,
    library.jodaConvert,
    library.jenaLibs,
    library.jenaTest,
    library.jwt,
    library.logbackClassic,
    library.rdf4jRioTurtle,
    library.rdf4jQueryParserSparql,
    library.sayonHE,
    library.scalaArm,
    library.scalaJava8Compat,
    library.scalaLogging,
    library.scalaTest,
    library.scalaXml,
    library.scallop,
    library.springSecurityCore,
    library.xmlunitCore
)

lazy val library =
    new {
        object Version {
            val akkaBase = &quot;2.5.9&quot;
            val akkaHttp = &quot;10.0.11&quot;
            val jena = &quot;3.4.0&quot;
            val aspectj = &quot;1.8.7&quot;
            val kamon = &quot;0.5.2&quot;
        }

        // akka
        val akkaActor              = &quot;com.typesafe.akka&quot;            %% &quot;akka-actor&quot;               % Version.akkaBase
        val akkaAgent              = &quot;com.typesafe.akka&quot;            %% &quot;akka-agent&quot;               % Version.akkaBase
        val akkaStream             = &quot;com.typesafe.akka&quot;            %% &quot;akka-stream&quot;              % Version.akkaBase
        val akkaSlf4j              = &quot;com.typesafe.akka&quot;            %% &quot;akka-slf4j&quot;               % Version.akkaBase
        val akkaHttp               = &quot;com.typesafe.akka&quot;            %% &quot;akka-http&quot;                % Version.akkaHttp
        val akkaHttpXml            = &quot;com.typesafe.akka&quot;            %% &quot;akka-http-xml&quot;            % Version.akkaHttp
        val akkaHttpSprayJson      = &quot;com.typesafe.akka&quot;            %% &quot;akka-http-spray-json&quot;     % Version.akkaHttp
        val akkaHttpJacksonJava    = &quot;com.typesafe.akka&quot;            %% &quot;akka-http-jackson&quot;        % Version.akkaHttp
        val akkaTestkit            = &quot;com.typesafe.akka&quot;            %% &quot;akka-testkit&quot;             % Version.akkaBase    % &quot;test, fuseki, graphdb, tdb, it, fuseki-it&quot;
        val akkaHttpTestkit        = &quot;com.typesafe.akka&quot;            %% &quot;akka-http-testkit&quot;        % Version.akkaHttp    % &quot;test, fuseki, graphdb, tdb, it, fuseki-it&quot;
        val akkaStreamTestkit      = &quot;com.typesafe.akka&quot;            %% &quot;akka-stream-testkit&quot;      % Version.akkaBase    % &quot;test, fuseki, graphdb, tdb, it, fuseki-it&quot;
        val scalaTest              = &quot;org.scalatest&quot;                %% &quot;scalatest&quot;                % &quot;3.0.4&quot;             % &quot;test, fuseki, graphdb, tdb, it, fuseki-it&quot;

        //CORS support
        val akkaHttpCors           = &quot;ch.megard&quot;                    %% &quot;akka-http-cors&quot;           % &quot;0.1.10&quot;

        // jena
        val jenaLibs               = &quot;org.apache.jena&quot;               % &quot;apache-jena-libs&quot;         % Version.jena exclude(&quot;org.slf4j&quot;, &quot;slf4j-log4j12&quot;) exclude(&quot;commons-codec&quot;, &quot;commons-codec&quot;)
        val jenaTest               = &quot;org.apache.jena&quot;               % &quot;jena-text&quot;                % Version.jena exclude(&quot;org.slf4j&quot;, &quot;slf4j-log4j12&quot;) exclude(&quot;commons-codec&quot;, &quot;commons-codec&quot;)

        // logging
        val scalaLogging           = &quot;com.typesafe.scala-logging&quot;   %% &quot;scala-logging&quot;            % &quot;3.5.0&quot;
        val logbackClassic         = &quot;ch.qos.logback&quot;                % &quot;logback-classic&quot;          % &quot;1.1.7&quot;

        // input validation
        val commonsValidator       = &quot;commons-validator&quot;             % &quot;commons-validator&quot;        % &quot;1.6&quot; exclude(&quot;commons-logging&quot;, &quot;commons-logging&quot;)

        // authentication
        val bcprov                 = &quot;org.bouncycastle&quot;              % &quot;bcprov-jdk15on&quot;           % &quot;1.56&quot;
        val springSecurityCore     = &quot;org.springframework.security&quot;  % &quot;spring-security-core&quot;     % &quot;4.2.3.RELEASE&quot; exclude(&quot;commons-logging&quot;, &quot;commons-logging&quot;) exclude(&quot;org.springframework&quot;, &quot;spring-aop&quot;)
        val jwt                    = &quot;io.igl&quot;                       %% &quot;jwt&quot;                      % &quot;1.2.2&quot; exclude(&quot;commons-codec&quot;, &quot;commons-codec&quot;)

        // caching
        val ehcache                = &quot;net.sf.ehcache&quot;                % &quot;ehcache&quot;                  % &quot;2.10.0&quot;

        // monitoring - disabled for now
        val aspectjWeaver          = &quot;org.aspectj&quot;                   % &quot;aspectjweaver&quot;            % Version.aspectj
        val aspectjRt              = &quot;org.aspectj&quot;                   % &quot;aspectjrt&quot;                % Version.aspectj
        val kamonCore              = &quot;io.kamon&quot;                     %% &quot;kamon-core&quot;               % Version.kamon
        val kamonSpray             = &quot;io.kamon&quot;                     %% &quot;kamon-spray&quot;              % Version.kamon
        val kamonStatsD            = &quot;io.kamon&quot;                     %% &quot;kamon-statsd&quot;             % Version.kamon
        val kamonLogReporter       = &quot;io.kamon&quot;                     %% &quot;kamon-log-reporter&quot;       % Version.kamon
        val kamonSystemMetrics     = &quot;io.kamon&quot;                     %% &quot;kamon-system-metrics&quot;     % Version.kamon
        val kamonNewRelic          = &quot;io.kamon&quot;                     %% &quot;kamon-newrelic&quot;           % Version.kamon

        // other
        //&quot;javax.transaction&quot; % &quot;transaction-api&quot; % &quot;1.1-rev-1&quot;,
        val commonsLang3           = &quot;org.apache.commons&quot;            % &quot;commons-lang3&quot;            % &quot;3.4&quot;
        val commonsIo              = &quot;commons-io&quot;                    % &quot;commons-io&quot;               % &quot;2.4&quot;
        val commonsBeanUtil        = &quot;commons-beanutils&quot;             % &quot;commons-beanutils&quot;        % &quot;1.9.2&quot; exclude(&quot;commons-logging&quot;, &quot;commons-logging&quot;) // not used by us, but need newest version to prevent this problem: http://stackoverflow.com/questions/14402745/duplicate-classes-in-commons-collections-and-commons-beanutils
        val jodd                   = &quot;org.jodd&quot;                      % &quot;jodd&quot;                     % &quot;3.2.6&quot;
        val jodaTime               = &quot;joda-time&quot;                     % &quot;joda-time&quot;                % &quot;2.9.1&quot;
        val jodaConvert            = &quot;org.joda&quot;                      % &quot;joda-convert&quot;             % &quot;1.8&quot;
        val diff                   = &quot;com.sksamuel.diff&quot;             % &quot;diff&quot;                     % &quot;1.1.11&quot;
        val xmlunitCore            = &quot;org.xmlunit&quot;                   % &quot;xmlunit-core&quot;             % &quot;2.1.1&quot;

        // other
        val rdf4jRioTurtle         = &quot;org.eclipse.rdf4j&quot;             % &quot;rdf4j-rio-turtle&quot;         % &quot;2.2.1&quot;
        val rdf4jQueryParserSparql = &quot;org.eclipse.rdf4j&quot;             % &quot;rdf4j-queryparser-sparql&quot; % &quot;2.2.1&quot;
        val scallop                = &quot;org.rogach&quot;                   %% &quot;scallop&quot;                  % &quot;2.0.5&quot;
        val gwtServlet             = &quot;com.google.gwt&quot;                % &quot;gwt-servlet&quot;              % &quot;2.8.0&quot;
        val sayonHE                = &quot;net.sf.saxon&quot;                  % &quot;Saxon-HE&quot;                 % &quot;9.7.0-14&quot;

        val scalaXml               = &quot;org.scala-lang.modules&quot;       %% &quot;scala-xml&quot;                % &quot;1.0.6&quot;
        val scalaArm               = &quot;com.jsuereth&quot;                  % &quot;scala-arm_2.12&quot;           % &quot;2.0&quot;
        val scalaJava8Compat       = &quot;org.scala-lang.modules&quot;        % &quot;scala-java8-compat_2.12&quot;  % &quot;0.8.0&quot;

        // provides akka jackson (json) support
        val akkaHttpCirce          = &quot;de.heikoseeberger&quot;            %% &quot;akka-http-circe&quot;          % &quot;1.18.0&quot;
        val jacksonScala           = &quot;com.fasterxml.jackson.module&quot; %% &quot;jackson-module-scala&quot;     % &quot;2.9.0&quot;

        val jsonldJava             = &quot;com.github.jsonld-java&quot;        % &quot;jsonld-java&quot;              % &quot;0.10.0&quot;
    }

lazy val javaRunOptions = Seq(
    // &quot;-showversion&quot;,
    &quot;-Xms1G&quot;,
    &quot;-Xmx1G&quot;
    // &quot;-verbose:gc&quot;,
    //&quot;-XX:+UseG1GC&quot;,
    //&quot;-XX:MaxGCPauseMillis=500&quot;
)

lazy val javaBaseTestOptions = Seq(
    // &quot;-showversion&quot;,
    &quot;-Xms2G&quot;,
    &quot;-Xmx2G&quot;
    // &quot;-verbose:gc&quot;,
    //&quot;-XX:+UseG1GC&quot;,
    //&quot;-XX:MaxGCPauseMillis=500&quot;,
    //&quot;-XX:MaxMetaspaceSize=4096m&quot;
)

lazy val javaTestOptions = Seq(
    &quot;-Dconfig.resource=graphdb.conf&quot;
) ++ javaBaseTestOptions

lazy val FusekiTest = config(&quot;fuseki&quot;) extend(Test)
lazy val javaFusekiTestOptions = Seq(
    &quot;-Dconfig.resource=fuseki.conf&quot;
) ++ javaBaseTestOptions

lazy val FusekiIntegrationTest = config(&quot;fuseki-it&quot;) extend(IntegrationTest)
lazy val javaFusekiIntegrationTestOptions = Seq(
    &quot;-Dconfig.resource=fuseki.conf&quot;
) ++ javaBaseTestOptions

lazy val GraphDBTest = config(&quot;graphdb&quot;) extend(Test)
lazy val javaGraphDBTestOptions = Seq(
    &quot;-Dconfig.resource=graphdb.conf&quot;
) ++ javaBaseTestOptions

lazy val EmbeddedJenaTDBTest = config(&quot;tdb&quot;) extend(Test)
lazy val javaEmbeddedJenaTDBTestOptions = Seq(
    &quot;-Dconfig.resource=jenatdb.conf&quot;
) ++ javaBaseTestOptions

// The &#39;IntegrationTest&#39; config does not need to be created here, as it is a built-in config!
// The standard testing tasks are available, but must be prefixed with &#39;it:&#39;, e.g., &#39;it:test&#39;
// The test need to be stored in the &#39;it&#39; (and not &#39;test&#39;) folder. The standard source hierarchy is used, e.g., &#39;src/it/scala&#39;
lazy val javaIntegrationTestOptions = Seq(
    &quot;-Dconfig.resource=graphdb.conf&quot;
) ++ javaBaseTestOptions
</pre></div>
</div>
</div>
<div class="section" id="webapi-server-startup-flags">
<span id="id1"></span><h2><a class="toc-backref" href="#id11">Webapi Server Startup-Flags</a><a class="headerlink" href="#webapi-server-startup-flags" title="Permalink to this headline">¶</a></h2>
<p>The Webapi-Server can be started with a number of flags. These flags can be supplied either to the <code class="docutils literal"><span class="pre">reStart</span></code> or the
<code class="docutils literal"><span class="pre">run</span></code> command in sbt, e.g.,:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sbt
&gt; reStart flag
</pre></div>
</div>
<p>or</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$sbt
&gt; run flag
</pre></div>
</div>
<div class="section" id="loaddemodata-flag">
<h3><a class="toc-backref" href="#id12"><code class="docutils literal"><span class="pre">loadDemoData</span></code> - Flag</a><a class="headerlink" href="#loaddemodata-flag" title="Permalink to this headline">¶</a></h3>
<p>When the webapi-server is started with the <code class="docutils literal"><span class="pre">loadDemoData</span></code> flag, then at startup, the data which is configured in
<code class="docutils literal"><span class="pre">application.conf</span></code> under the <code class="docutils literal"><span class="pre">app.triplestore.rdf-data</span></code> key is loaded into the triplestore, and any data in the
triplestore is removed beforehand.</p>
<p>Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sbt
&gt; reStart loadDemoData
</pre></div>
</div>
</div>
<div class="section" id="allowreloadoverhttp-flag">
<h3><a class="toc-backref" href="#id13"><code class="docutils literal"><span class="pre">allowReloadOverHTTP</span></code> - Flag</a><a class="headerlink" href="#allowreloadoverhttp-flag" title="Permalink to this headline">¶</a></h3>
<p>When the webapi.server is started with the <code class="docutils literal"><span class="pre">allowReloadOverHTTP</span></code> flag, then the
<code class="docutils literal"><span class="pre">v1/store/ResetTriplestoreContent</span></code> route is activated. This route accepts a <code class="docutils literal"><span class="pre">POST</span></code> request, with a json payload
consisting of the following exemplary content:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;../knora-ontologies/knora-base.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/ontology/knora-base&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;../knora-ontologies/knora-dc.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/ontology/dc&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;../knora-ontologies/salsah-gui.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/ontology/salsah-gui&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;_test_data/ontologies/incunabula-onto.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/ontology/incunabula&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;_test_data/all_data/incunabula-data.ttl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http://www.knora.org/data/incunabula&quot;</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This content corresponds to the payload sent with the <code class="docutils literal"><span class="pre">ResetTriplestoreContent</span></code> message, defined inside the
<code class="docutils literal"><span class="pre">org.knora.webapi.messages.v1.store.triplestoremessages</span></code> package. The <code class="docutils literal"><span class="pre">path</span></code> being the relative path to the <code class="docutils literal"><span class="pre">ttl</span></code>
file which will be loaded into a named graph by the name of <code class="docutils literal"><span class="pre">name</span></code>.</p>
<p>Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sbt
&gt; reStart allowReloadOverHTTP
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knora-ontologies/index.html">The Knora Ontologies</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The Knora API Server</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../deployment/index.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design-documentation/index.html">Knora API Server Design Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Developing the Knora API Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_v1/index.html">Using API V1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_v2/index.html">Using API V2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../salsah/index.html">SALSAH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sipi/index.html">Sipi</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="graphdb.html" title="Starting GraphDB"
              >previous</a> |
            <a href="intellij-config.html" title="Setup IntelliJ for development of Knora"
              >next</a> |
            <a href="../../../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../../../_sources/rst/knora-api-server/development/build-process.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Lukas Rosenthaler, Benjamin Geer, Ivan Subotic, Tobias Schweizer, André Kilchenmann, and Sepideh Alassi.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>